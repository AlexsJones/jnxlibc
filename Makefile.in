BUILD_DIR=build

all: setup main_artifact shipping teardown
release: setup main_artifact_release shipping teardown
setup:
	mkdir -p build
	cp src/**/*.c build
	cp src/**/*.h build
teardown:
	rm -rf build
main_artifact:
	gcc -Wall -fPIC -DDEBUG -c $(BUILD_DIR)/*.c
	build.shared.object
	rm *.o
	find . -type f -name "*~" -exec rm {} \;
main_artifact_release:
	gcc -Wno-unused-function -fPIC -DRELEASE -c $(BUILD_DIR)/*.c
	build.shared.object
	rm *.o
	find . -type f -name "*~" -exec rm {} \;
shipping:
	mkdir -p lib; 
	move.shared.object
	mkdir -p lib/jnxc_headers; cp $(BUILD_DIR)/*.h lib/jnxc_headers;
install:
	install.shared.object
	rm -rf lib
